(function(E){var B={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},M={onHoverOverNode:function(I,N){var L=J.getSetting(I.data.treeId),H=J.getRoot(L);if(H.curHoverNode!=N){M.onHoverOutNode(I)}H.curHoverNode=N;T.addHoverDom(L,N)},onHoverOutNode:function(H){var H=J.getSetting(H.data.treeId),I=J.getRoot(H);if(I.curHoverNode&&!J.isSelectedNode(H,I.curHoverNode)){T.removeTreeDom(H,I.curHoverNode),I.curHoverNode=null}},onMousedownNode:function(w,z){function y(r){if(Aj.dragFlag==0&&Math.abs(Ae-r.clientX)<Ac.edit.drag.minMoveSize&&Math.abs(Af-r.clientY)<Ac.edit.drag.minMoveSize){return !0}var u,H,l,e,h;h=Ac.data.key.children;Ah.css("cursor","pointer");if(Aj.dragFlag==0){if(U.apply(Ac.callback.beforeDrag,[Ac.treeId,n],!0)==!1){return I(r),!0}for(u=0,H=n.length;u<H;u++){if(u==0){Aj.dragNodeShowBefore=[]}l=n[u];l.isParent&&l.open?(T.expandCollapseNode(Ac,l,!l.open),Aj.dragNodeShowBefore[l.tId]=!0):Aj.dragNodeShowBefore[l.tId]=!1}Aj.dragFlag=1;Y.showHoverDom=!1;U.showIfameMask(Ac,!0);l=!0;e=-1;if(n.length>1){var O=n[0].parentTId?n[0].getParentNode()[h]:J.getNodes(Ac);h=[];for(u=0,H=O.length;u<H;u++){if(Aj.dragNodeShowBefore[O[u].tId]!==void 0&&(l&&e>-1&&e+1!==u&&(l=!1),h.push(O[u]),e=u),n.length===h.length){n=h;break}}}l&&(Ad=n[0].getPreNode(),o=n[n.length-1].getNextNode());Am=G("<ul class='zTreeDragUL'></ul>",Ac);for(u=0,H=n.length;u<H;u++){l=n[u],l.editNameFlag=!1,T.selectNode(Ac,l,u>0),T.removeTreeDom(Ac,l),u>Ac.edit.drag.maxShowNodeNum-1||(e=G("<li id='"+l.tId+"_tmp'></li>",Ac),e.append(G(l,W.id.A,Ac).clone()),e.css("padding","0"),e.children("#"+l.tId+W.id.A).removeClass(W.node.CURSELECTED),Am.append(e),u==Ac.edit.drag.maxShowNodeNum-1&&(e=G("<li id='"+l.tId+"_moretmp'><a>  ...  </a></li>",Ac),Am.append(e)))}Am.attr("id",n[0].tId+W.id.UL+"_tmp");Am.addClass(Ac.treeObj.attr("class"));Am.appendTo(Ah);Ai=G("<span class='tmpzTreeMove_arrow'></span>",Ac);Ai.attr("id","zTreeMove_arrow_tmp");Ai.appendTo(Ah);Ac.treeObj.trigger(W.event.DRAG,[r,Ac.treeId,n])}if(Aj.dragFlag==1){P&&Ai.attr("id")==r.target.id&&Z&&r.clientX+Al.scrollLeft()+2>E("#"+Z+W.id.A,P).offset().left?(l=E("#"+Z+W.id.A,P),r.target=l.length>0?l.get(0):r.target):P&&(P.removeClass(W.node.TMPTARGET_TREE),Z&&E("#"+Z+W.id.A,P).removeClass(W.node.TMPTARGET_NODE+"_"+W.move.TYPE_PREV).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER));Z=P=null;X=!1;g=Ac;l=J.getSettings();for(var As in l){if(l[As].treeId&&l[As].edit.enable&&l[As].treeId!=Ac.treeId&&(r.target.id==l[As].treeId||E(r.target).parents("#"+l[As].treeId).length>0)){X=!0,g=l[As]}}As=Al.scrollTop();e=Al.scrollLeft();h=g.treeObj.offset();u=g.treeObj.get(0).scrollHeight;l=g.treeObj.get(0).scrollWidth;H=r.clientY+As-h.top;var L=g.treeObj.height()+h.top-r.clientY-As,N=r.clientX+e-h.left,Ar=g.treeObj.width()+h.left-r.clientX-e;h=H<Ac.edit.drag.borderMax&&H>Ac.edit.drag.borderMin;var O=L<Ac.edit.drag.borderMax&&L>Ac.edit.drag.borderMin,v=N<Ac.edit.drag.borderMax&&N>Ac.edit.drag.borderMin,Ao=Ar<Ac.edit.drag.borderMax&&Ar>Ac.edit.drag.borderMin,L=H>Ac.edit.drag.borderMin&&L>Ac.edit.drag.borderMin&&N>Ac.edit.drag.borderMin&&Ar>Ac.edit.drag.borderMin,N=h&&g.treeObj.scrollTop()<=0,Ar=O&&g.treeObj.scrollTop()+g.treeObj.height()+10>=u,s=v&&g.treeObj.scrollLeft()<=0,t=Ao&&g.treeObj.scrollLeft()+g.treeObj.width()+10>=l;if(r.target&&U.isChildOrSelf(r.target,g.treeId)){for(var Ap=r.target;Ap&&Ap.tagName&&!U.eqs(Ap.tagName,"li")&&Ap.id!=g.treeId;){Ap=Ap.parentNode}var At=!0;for(u=0,H=n.length;u<H;u++){if(l=n[u],Ap.id===l.tId){At=!1;break}else{if(G(l,Ac).find("#"+Ap.id).length>0){At=!1;break}}}if(At&&r.target&&U.isChildOrSelf(r.target,Ap.id+W.id.A)){P=E(Ap),Z=Ap.id}}l=n[0];if(L&&U.isChildOrSelf(r.target,g.treeId)){if(!P&&(r.target.id==g.treeId||N||Ar||s||t)&&(X||!X&&l.parentTId)){P=g.treeObj}h?g.treeObj.scrollTop(g.treeObj.scrollTop()-10):O&&g.treeObj.scrollTop(g.treeObj.scrollTop()+10);v?g.treeObj.scrollLeft(g.treeObj.scrollLeft()-10):Ao&&g.treeObj.scrollLeft(g.treeObj.scrollLeft()+10);P&&P!=g.treeObj&&P.offset().left<g.treeObj.offset().left&&g.treeObj.scrollLeft(g.treeObj.scrollLeft()+P.offset().left-g.treeObj.offset().left)}Am.css({top:r.clientY+As+3+"px",left:r.clientX+e+3+"px"});h=u=0;if(P&&P.attr("id")!=g.treeId){var Aq=Z==null?null:J.getNodeCache(g,Z);H=(r.ctrlKey||r.metaKey)&&Ac.edit.drag.isMove&&Ac.edit.drag.isCopy||!Ac.edit.drag.isMove&&Ac.edit.drag.isCopy;u=!!(Ad&&Z===Ad.tId);h=!!(o&&Z===o.tId);e=l.parentTId&&l.parentTId==Z;l=(H||!h)&&U.apply(g.edit.drag.prev,[g.treeId,n,Aq],!!g.edit.drag.prev);u=(H||!u)&&U.apply(g.edit.drag.next,[g.treeId,n,Aq],!!g.edit.drag.next);Ao=(H||!e)&&!(g.data.keep.leaf&&!Aq.isParent)&&U.apply(g.edit.drag.inner,[g.treeId,n,Aq],!!g.edit.drag.inner);if(!l&&!u&&!Ao){if(P=null,Z="",Ak=W.move.TYPE_INNER,Ai.css({display:"none"}),window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}}else{H=E("#"+Z+W.id.A,P);h=Aq.isLastNode?null:E("#"+Aq.getNextNode().tId+W.id.A,P.next());O=H.offset().top;e=H.offset().left;v=l?Ao?0.25:u?0.5:1:-1;Ao=u?Ao?0.75:l?0.5:0:-1;As=(r.clientY+As-O)/H.height();(v==1||As<=v&&As>=-0.2)&&l?(u=1-Ai.width(),h=O-Ai.height()/2,Ak=W.move.TYPE_PREV):(Ao==0||As>=Ao&&As<=1.2)&&u?(u=1-Ai.width(),h=h==null||Aq.isParent&&Aq.open?O+H.height()-Ai.height()/2:h.offset().top-Ai.height()/2,Ak=W.move.TYPE_NEXT):(u=5-Ai.width(),h=O,Ak=W.move.TYPE_INNER);Ai.css({display:"block",top:h+"px",left:e+u+"px"});H.addClass(W.node.TMPTARGET_NODE+"_"+Ak);if(Aa!=Z||Ab!=Ak){Ag=(new Date).getTime()}if(Aq&&Aq.isParent&&Ak==W.move.TYPE_INNER&&(As=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==Aq.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===Aq.tId&&(As=!1),As)){window.zTreeMoveTimer=setTimeout(function(){Ak==W.move.TYPE_INNER&&Aq&&Aq.isParent&&!Aq.open&&(new Date).getTime()-Ag>g.edit.drag.autoOpenTime&&U.apply(g.callback.beforeDragOpen,[g.treeId,Aq],!0)&&(T.switchNode(g,Aq),g.edit.drag.autoExpandTrigger&&g.treeObj.trigger(W.event.EXPAND,[g.treeId,Aq]))},g.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=Aq.tId}}}else{if(Ak=W.move.TYPE_INNER,P&&U.apply(g.edit.drag.inner,[g.treeId,n,null],!!g.edit.drag.inner)?P.addClass(W.node.TMPTARGET_TREE):P=null,Ai.css({display:"none"}),window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}}Aa=Z;Ab=Ak;Ac.treeObj.trigger(W.event.DRAGMOVE,[r,Ac.treeId,n])}return !1}function I(c){if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}Ab=Aa=null;Al.unbind("mousemove",y);Al.unbind("mouseup",I);Al.unbind("selectstart",f);Ah.css("cursor","auto");P&&(P.removeClass(W.node.TMPTARGET_TREE),Z&&E("#"+Z+W.id.A,P).removeClass(W.node.TMPTARGET_NODE+"_"+W.move.TYPE_PREV).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER));U.showIfameMask(Ac,!1);Y.showHoverDom=!0;if(Aj.dragFlag!=0){Aj.dragFlag=0;var e,L,h;for(e=0,L=n.length;e<L;e++){h=n[e],h.isParent&&Aj.dragNodeShowBefore[h.tId]&&!h.open&&(T.expandCollapseNode(Ac,h,!h.open),delete Aj.dragNodeShowBefore[h.tId])}Am&&Am.remove();Ai&&Ai.remove();var N=(c.ctrlKey||c.metaKey)&&Ac.edit.drag.isMove&&Ac.edit.drag.isCopy||!Ac.edit.drag.isMove&&Ac.edit.drag.isCopy;!N&&P&&Z&&n[0].parentTId&&Z==n[0].parentTId&&Ak==W.move.TYPE_INNER&&(P=null);if(P){var O=Z==null?null:J.getNodeCache(g,Z);if(U.apply(Ac.callback.beforeDrop,[g.treeId,n,O,Ak,N],!0)==!1){T.selectNodes(An,n)}else{var H=N?U.clone(n):n;e=function(){if(X){if(!N){for(var i=0,b=n.length;i<b;i++){T.removeNode(Ac,n[i])}}if(Ak==W.move.TYPE_INNER){T.addNodes(g,O,H)}else{if(T.addNodes(g,O.getParentNode(),H),Ak==W.move.TYPE_PREV){for(i=0,b=H.length;i<b;i++){T.moveNode(g,O,H[i],Ak,!1)}}else{for(i=-1,b=H.length-1;i<b;b--){T.moveNode(g,O,H[b],Ak,!1)}}}}else{if(N&&Ak==W.move.TYPE_INNER){T.addNodes(g,O,H)}else{if(N&&T.addNodes(g,O.getParentNode(),H),Ak!=W.move.TYPE_NEXT){for(i=0,b=H.length;i<b;i++){T.moveNode(g,O,H[i],Ak,!1)}}else{for(i=-1,b=H.length-1;i<b;b--){T.moveNode(g,O,H[b],Ak,!1)}}}}T.selectNodes(g,H);G(H[0],Ac).focus().blur();Ac.treeObj.trigger(W.event.DROP,[c,g.treeId,H,O,Ak,N])};Ak==W.move.TYPE_INNER&&U.canAsync(g,O)?T.asyncNode(g,O,!1,e):e()}}else{T.selectNodes(An,n),Ac.treeObj.trigger(W.event.DROP,[c,Ac.treeId,n,null,null,null])}}}function f(){return !1}var m,d,Ac=J.getSetting(w.data.treeId),Aj=J.getRoot(Ac),Y=J.getRoots();if(w.button==2||!Ac.edit.enable||!Ac.edit.drag.isCopy&&!Ac.edit.drag.isMove){return !0}var Q=w.target,V=J.getRoot(Ac).curSelectedList,n=[];if(J.isSelectedNode(Ac,z)){for(m=0,d=V.length;m<d;m++){if(V[m].editNameFlag&&U.eqs(Q.tagName,"input")&&Q.getAttribute("treeNode"+W.id.INPUT)!==null){return !0}n.push(V[m]);if(n[0].parentTId!==V[m].parentTId){n=[z];break}}}else{n=[z]}T.editNodeBlur=!0;T.cancelCurEditNode(Ac);var Al=E(Ac.treeObj.get(0).ownerDocument),Ah=E(Ac.treeObj.get(0).ownerDocument.body),Am,Ai,P,X=!1,g=Ac,An=Ac,Ad,o,Aa=null,Ab=null,Z=null,Ak=W.move.TYPE_INNER,Ae=w.clientX,Af=w.clientY,Ag=(new Date).getTime();U.uCanDo(Ac)&&Al.bind("mousemove",y);Al.bind("mouseup",I);Al.bind("selectstart",f);w.preventDefault&&w.preventDefault();return !0}};E.extend(!0,E.fn.zTree.consts,B);E.extend(!0,E.fn.zTree._z,{tools:{getAbs:function(H){H=H.getBoundingClientRect();return[H.left+(document.body.scrollLeft+document.documentElement.scrollLeft),H.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(H){H.get(0)&&(H.focus(),U.setCursorPosition(H.get(0),H.val().length))},inputSelect:function(H){H.get(0)&&(H.focus(),H.select())},setCursorPosition:function(H,L){if(H.setSelectionRange){H.focus(),H.setSelectionRange(L,L)}else{if(H.createTextRange){var I=H.createTextRange();I.collapse(!0);I.moveEnd("character",L);I.moveStart("character",L);I.select()}}},showIfameMask:function(N,P){for(var O=J.getRoot(N);O.dragMaskList.length>0;){O.dragMaskList[0].remove(),O.dragMaskList.shift()}if(P){for(var V=G("iframe",N),Q=0,L=V.length;Q<L;Q++){var I=V.get(Q),H=U.getAbs(I),I=G("<div id='zTreeMask_"+Q+"' class='zTreeMask' style='top:"+H[1]+"px; left:"+H[0]+"px; width:"+I.offsetWidth+"px; height:"+I.offsetHeight+"px;'></div>",N);I.appendTo(G("body",N));O.dragMaskList.push(I)}}}},view:{addEditBtn:function(I,N){if(!(N.editNameFlag||G(N,W.id.EDIT,I).length>0)&&U.apply(I.edit.showRenameBtn,[I.treeId,N],I.edit.showRenameBtn)){var L=G(N,W.id.A,I),H="<span class='"+W.className.BUTTON+" edit' id='"+N.tId+W.id.EDIT+"' title='"+U.apply(I.edit.renameTitle,[I.treeId,N],I.edit.renameTitle)+"' treeNode"+W.id.EDIT+" style='display:none;'></span>";L.append(H);G(N,W.id.EDIT,I).bind("click",function(){if(!U.uCanDo(I)||U.apply(I.callback.beforeEditName,[I.treeId,N],!0)==!1){return !1}T.editNode(I,N);return !1}).show()}},addRemoveBtn:function(I,N){if(!(N.editNameFlag||G(N,W.id.REMOVE,I).length>0)&&U.apply(I.edit.showRemoveBtn,[I.treeId,N],I.edit.showRemoveBtn)){var L=G(N,W.id.A,I),H="<span class='"+W.className.BUTTON+" remove' id='"+N.tId+W.id.REMOVE+"' title='"+U.apply(I.edit.removeTitle,[I.treeId,N],I.edit.removeTitle)+"' treeNode"+W.id.REMOVE+" style='display:none;'></span>";L.append(H);G(N,W.id.REMOVE,I).bind("click",function(){if(!U.uCanDo(I)||U.apply(I.callback.beforeRemove,[I.treeId,N],!0)==!1){return !1}T.removeNode(I,N);I.treeObj.trigger(W.event.REMOVE,[I.treeId,N]);return !1}).bind("mousedown",function(){return !0}).show()}},addHoverDom:function(H,I){if(J.getRoots().showHoverDom){I.isHover=!0,H.edit.enable&&(T.addEditBtn(H,I),T.addRemoveBtn(H,I)),U.apply(H.view.addHoverDom,[H.treeId,I])}},cancelCurEditNode:function(N,P,O){var I=J.getRoot(N),Q=N.data.key.name,L=I.curEditNode;if(L){var H=I.curEditInput,P=P?P:O?L[Q]:H.val();if(U.apply(N.callback.beforeRename,[N.treeId,L,P,O],!0)===!1){return !1}L[Q]=P;G(L,W.id.A,N).removeClass(W.node.CURSELECTED_EDIT);H.unbind();T.setNodeName(N,L);L.editNameFlag=!1;I.curEditNode=null;I.curEditInput=null;T.selectNode(N,L,!1);N.treeObj.trigger(W.event.RENAME,[N.treeId,L,O])}return I.noSelection=!0},editNode:function(I,N){var L=J.getRoot(I);T.editNodeBlur=!1;if(J.isSelectedNode(I,N)&&L.curEditNode==N&&N.editNameFlag){setTimeout(function(){U.inputFocus(L.curEditInput)},0)}else{var H=I.data.key.name;N.editNameFlag=!0;T.removeTreeDom(I,N);T.cancelCurEditNode(I);T.selectNode(I,N,!1);G(N,W.id.SPAN,I).html("<input type=text class='rename' id='"+N.tId+W.id.INPUT+"' treeNode"+W.id.INPUT+" >");var O=G(N,W.id.INPUT,I);O.attr("value",N[H]);I.edit.editNameSelectAll?U.inputSelect(O):U.inputFocus(O);O.bind("blur",function(){T.editNodeBlur||T.cancelCurEditNode(I)}).bind("keydown",function(P){P.keyCode=="13"?(T.editNodeBlur=!0,T.cancelCurEditNode(I)):P.keyCode=="27"&&T.cancelCurEditNode(I,null,!0)}).bind("click",function(){return !1}).bind("dblclick",function(){return !1});G(N,W.id.A,I).addClass(W.node.CURSELECTED_EDIT);L.curEditInput=O;L.noSelection=!1;L.curEditNode=N}},moveNode:function(d,h,f,H,V,X){var Q=J.getRoot(d),N=d.data.key.children;if(h!=f&&(!d.data.keep.leaf||!h||h.isParent||H!=W.move.TYPE_INNER)){var n=f.parentTId?f.getParentNode():Q,P=h===null||h==Q;P&&h===null&&(h=Q);if(P){H=W.move.TYPE_INNER}Q=h.parentTId?h.getParentNode():Q;if(H!=W.move.TYPE_PREV&&H!=W.move.TYPE_NEXT){H=W.move.TYPE_INNER}if(H==W.move.TYPE_INNER){if(P){f.parentTId=null}else{if(!h.isParent){h.isParent=!0,h.open=!!h.open,T.setNodeLineIcos(d,h)}f.parentTId=h.tId}}var I;P?I=P=d.treeObj:(!X&&H==W.move.TYPE_INNER?T.expandCollapseNode(d,h,!0,!1):X||T.expandCollapseNode(d,h.getParentNode(),!0,!1),P=G(h,d),I=G(h,W.id.UL,d),P.get(0)&&!I.get(0)&&(I=[],T.makeUlHtml(d,h,I,""),P.append(I.join(""))),I=G(h,W.id.UL,d));var L=G(f,d);L.get(0)?P.get(0)||L.remove():L=T.appendNodes(d,f.level,[f],null,!1,!0).join("");I.get(0)&&H==W.move.TYPE_INNER?I.append(L):P.get(0)&&H==W.move.TYPE_PREV?P.before(L):P.get(0)&&H==W.move.TYPE_NEXT&&P.after(L);var Z=-1,O=0,m=null,P=null,Y=f.level;if(f.isFirstNode){if(Z=0,n[N].length>1){m=n[N][1],m.isFirstNode=!0}}else{if(f.isLastNode){Z=n[N].length-1,m=n[N][Z-1],m.isLastNode=!0}else{for(I=0,L=n[N].length;I<L;I++){if(n[N][I].tId==f.tId){Z=I;break}}}}Z>=0&&n[N].splice(Z,1);if(H!=W.move.TYPE_INNER){for(I=0,L=Q[N].length;I<L;I++){Q[N][I].tId==h.tId&&(O=I)}}if(H==W.move.TYPE_INNER){h[N]||(h[N]=[]);if(h[N].length>0){P=h[N][h[N].length-1],P.isLastNode=!1}h[N].splice(h[N].length,0,f);f.isLastNode=!0;f.isFirstNode=h[N].length==1}else{h.isFirstNode&&H==W.move.TYPE_PREV?(Q[N].splice(O,0,f),P=h,P.isFirstNode=!1,f.parentTId=h.parentTId,f.isFirstNode=!0,f.isLastNode=!1):h.isLastNode&&H==W.move.TYPE_NEXT?(Q[N].splice(O+1,0,f),P=h,P.isLastNode=!1,f.parentTId=h.parentTId,f.isFirstNode=!1,f.isLastNode=!0):(H==W.move.TYPE_PREV?Q[N].splice(O,0,f):Q[N].splice(O+1,0,f),f.parentTId=h.parentTId,f.isFirstNode=!1,f.isLastNode=!1)}J.fixPIdKeyValue(d,f);J.setSonNodeLevel(d,f.getParentNode(),f);T.setNodeLineIcos(d,f);T.repairNodeLevelClass(d,f,Y);!d.data.keep.parent&&n[N].length<1?(n.isParent=!1,n.open=!1,h=G(n,W.id.UL,d),H=G(n,W.id.SWITCH,d),N=G(n,W.id.ICON,d),T.replaceSwitchClass(n,H,W.folder.DOCU),T.replaceIcoClass(n,N,W.folder.DOCU),h.css("display","none")):m&&T.setNodeLineIcos(d,m);P&&T.setNodeLineIcos(d,P);d.check&&d.check.enable&&T.repairChkClass&&(T.repairChkClass(d,n),T.repairParentChkClassWithSelf(d,n),n!=f.parent&&T.repairParentChkClassWithSelf(d,f));X||T.expandCollapseParentNode(d,f.getParentNode(),!0,V)}},removeEditBtn:function(H,I){G(I,W.id.EDIT,H).unbind().remove()},removeRemoveBtn:function(H,I){G(I,W.id.REMOVE,H).unbind().remove()},removeTreeDom:function(H,I){I.isHover=!1;T.removeEditBtn(H,I);T.removeRemoveBtn(H,I);U.apply(H.view.removeHoverDom,[H.treeId,I])},repairNodeLevelClass:function(I,N,L){if(L!==N.level){var O=G(N,I),H=G(N,W.id.A,I),I=G(N,W.id.UL,I),L=W.className.LEVEL+L,N=W.className.LEVEL+N.level;O.removeClass(L);O.addClass(N);H.removeClass(L);H.addClass(N);I.removeClass(L);I.addClass(N)}},selectNodes:function(I,N){for(var L=0,H=N.length;L<H;L++){T.selectNode(I,N[L],L>0)}}},event:{},data:{setSonNodeLevel:function(I,N,L){if(L){var H=I.data.key.children;L.level=N?N.level+1:0;if(L[H]){for(var N=0,O=L[H].length;N<O;N++){L[H][N]&&J.setSonNodeLevel(I,L,L[H][N])}}}}}});var A=E.fn.zTree,U=A._z.tools,W=A.consts,T=A._z.view,J=A._z.data,G=U.$;J.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});J.addInitBind(function(H){var L=H.treeObj,I=W.event;L.bind(I.RENAME,function(P,O,N,Q){U.apply(H.callback.onRename,[P,O,N,Q])});L.bind(I.DRAG,function(P,O,N,Q){U.apply(H.callback.onDrag,[O,N,Q])});L.bind(I.DRAGMOVE,function(P,O,N,Q){U.apply(H.callback.onDragMove,[O,N,Q])});L.bind(I.DROP,function(X,V,N,Y,O,Q,P){U.apply(H.callback.onDrop,[V,N,Y,O,Q,P])})});J.addInitUnBind(function(H){var H=H.treeObj,I=W.event;H.unbind(I.RENAME);H.unbind(I.DRAG);H.unbind(I.DRAGMOVE);H.unbind(I.DROP)});J.addInitCache(function(){});J.addInitNode(function(H,L,I){if(I){I.isHover=!1,I.editNameFlag=!1}});J.addInitProxy(function(P){var V=P.target,Q=J.getSetting(P.data.treeId),X=P.relatedTarget,L="",N=null,I="",H=null,O=null;if(U.eqs(P.type,"mouseover")){if(O=U.getMDom(Q,V,[{tagName:"a",attrName:"treeNode"+W.id.A}])){L=U.getNodeMainDom(O).id,I="hoverOverNode"}}else{if(U.eqs(P.type,"mouseout")){O=U.getMDom(Q,X,[{tagName:"a",attrName:"treeNode"+W.id.A}]),O||(L="remove",I="hoverOutNode")}else{if(U.eqs(P.type,"mousedown")&&(O=U.getMDom(Q,V,[{tagName:"a",attrName:"treeNode"+W.id.A}]))){L=U.getNodeMainDom(O).id,I="mousedownNode"}}}if(L.length>0){switch(N=J.getNodeCache(Q,L),I){case"mousedownNode":H=M.onMousedownNode;break;case"hoverOverNode":H=M.onHoverOverNode;break;case"hoverOutNode":H=M.onHoverOutNode}}return{stop:!1,node:N,nodeEventType:I,nodeEventCallback:H,treeEventType:"",treeEventCallback:null}});J.addInitRoot(function(H){var H=J.getRoot(H),I=J.getRoots();H.curEditNode=null;H.curEditInput=null;H.curHoverNode=null;H.dragFlag=0;H.dragNodeShowBefore=[];H.dragMaskList=[];I.showHoverDom=!0});J.addZTreeTools(function(H,I){I.cancelEditName=function(L){J.getRoot(this.setting).curEditNode&&T.cancelCurEditNode(this.setting,L?L:null,!0)};I.copyNode=function(Q,P,V,N){if(!P){return null}if(Q&&!Q.isParent&&this.setting.data.keep.leaf&&V===W.move.TYPE_INNER){return null}var L=this,O=U.clone(P);if(!Q){Q=null,V=W.move.TYPE_INNER}V==W.move.TYPE_INNER?(P=function(){T.addNodes(L.setting,Q,[O],N)},U.canAsync(this.setting,Q)?T.asyncNode(this.setting,Q,N,P):P()):(T.addNodes(this.setting,Q.parentNode,[O],N),T.moveNode(this.setting,Q,O,V,!1,N));return O};I.editName=function(L){L&&L.tId&&L===J.getNodeCache(this.setting,L.tId)&&(L.parentTId&&T.expandCollapseParentNode(this.setting,L.getParentNode(),!0),T.editNode(this.setting,L))};I.moveNode=function(Q,P,V,N){function L(){T.moveNode(O.setting,Q,P,V,!1,N)}if(!P){return P}if(Q&&!Q.isParent&&this.setting.data.keep.leaf&&V===W.move.TYPE_INNER){return null}else{if(Q&&(P.parentTId==Q.tId&&V==W.move.TYPE_INNER||G(P,this.setting).find("#"+Q.tId).length>0)){return null}else{Q||(Q=null)}}var O=this;U.canAsync(this.setting,Q)&&V===W.move.TYPE_INNER?T.asyncNode(this.setting,Q,N,L):L();return P};I.setEditable=function(L){this.setting.edit.enable=L;return this.refresh()}});var C=T.cancelPreSelectedNode;T.cancelPreSelectedNode=function(L,O){for(var N=J.getRoot(L).curSelectedList,I=0,H=N.length;I<H;I++){if(!O||O===N[I]){if(T.removeTreeDom(L,N[I]),O){break}}}C&&C.apply(T,arguments)};var D=T.createNodes;T.createNodes=function(I,N,L,H){D&&D.apply(T,arguments);L&&T.repairParentChkClassWithSelf&&T.repairParentChkClassWithSelf(I,H)};var R=T.makeNodeUrl;T.makeNodeUrl=function(H,I){return H.edit.enable?null:R.apply(T,arguments)};var F=T.removeNode;T.removeNode=function(H,L){var I=J.getRoot(H);if(I.curEditNode===L){I.curEditNode=null}F&&F.apply(T,arguments)};var K=T.selectNode;T.selectNode=function(I,N,L){var H=J.getRoot(I);if(J.isSelectedNode(I,N)&&H.curEditNode==N&&N.editNameFlag){return !1}K&&K.apply(T,arguments);T.addHoverDom(I,N);return !0};var S=U.uCanDo;U.uCanDo=function(H,L){var I=J.getRoot(H);if(L&&(U.eqs(L.type,"mouseover")||U.eqs(L.type,"mouseout")||U.eqs(L.type,"mousedown")||U.eqs(L.type,"mouseup"))){return !0}if(I.curEditNode){T.editNodeBlur=!1,I.curEditInput.focus()}return !I.curEditNode&&(S?S.apply(T,arguments):!0)}})(jQuery);